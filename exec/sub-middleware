#!/usr/bin/env bash

function middleware-sub {
  local nm_source="$1"; shift

  if [[ "$(which "${SUB_MIDDLEWARE}-${1:-}" 2>&- || true)" ]]; then
    exec "${SUB_MIDDLEWARE}-${1}" "${@:2}"
  else
    "${SUB_MIDDLEWARE}" "$@" 
  fi
}

middleware-sub "$@"
